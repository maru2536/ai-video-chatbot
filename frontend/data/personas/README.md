# ペルソナデータ管理ガイド

このディレクトリでは、AIチャットボットが特定の人物として振る舞うためのペルソナデータを管理します。

## ファイル構成

- `personas.json` - 全ペルソナデータの定義ファイル
- `README.md` - このファイル（管理方法の説明）

## personas.json の構造

### 基本構造
```json
{
  "personas": [
    // ペルソナオブジェクトの配列
  ],
  "categories": [
    // カテゴリの配列
  ],
  "metadata": {
    // メタデータ
  }
}
```

### ペルソナオブジェクトの定義

```json
{
  "id": "unique-identifier",           // 一意のID（英数字とハイフン）
  "name": "表示名",                    // ユーザーに表示される名前
  "category": "カテゴリ",              // 文学者、科学者、実業家など
  "description": "簡潔な説明",         // 1-2行の人物紹介
  "personality": "性格の詳細説明",     // AIの性格設定
  "speakingStyle": "話し方の特徴",     // 話し方や文体の特徴
  "background": "背景・経歴",          // 人生経験や歴史的背景
  "expertise": ["専門分野1", "分野2"], // 専門知識の配列
  "catchPhrase": "特徴的な言葉",       // 口癖や名言
  "responseStyle": {
    "tone": "口調の特徴",              // 丁寧、情熱的、皮肉的など
    "vocabulary": "語彙の特徴",        // 文学的、科学的、ビジネス的など
    "approach": "アプローチ方法"       // 論理的、感情的、実践的など
  },
  "sampleResponses": [                 // サンプル回答（学習データとして使用）
    {
      "question": "質問例",
      "response": "その人物らしい回答例"
    }
  ],
  "createdAt": "2024-01-01T00:00:00Z", // 作成日時
  "updatedAt": "2024-01-01T00:00:00Z", // 更新日時
  "active": true                        // 有効/無効フラグ
}
```

## 新しいペルソナの追加方法

1. **IDの設定**: 英数字とハイフンのみ使用（例: `natsume-soseki`, `marie-curie`）
2. **基本情報の入力**: name, category, description を設定
3. **性格・話し方の定義**: personality, speakingStyle を詳細に記述
4. **専門分野の設定**: expertise 配列に関連分野を追加
5. **回答スタイルの定義**: responseStyle で口調や語彙を指定
6. **サンプル回答の作成**: sampleResponses でその人物らしい回答例を提供

## チューニングのポイント

### 1. 性格設定（personality）
- 具体的で詳細に記述する
- 矛盾しない一貫した特徴を設定
- 歴史的事実に基づいた性格描写

### 2. 話し方（speakingStyle）
- 口調、語尾、方言などの特徴
- 時代背景に合った言葉遣い
- 専門用語の使用傾向

### 3. 回答スタイル（responseStyle）
- **tone**: 温かい、厳格、皮肉的、知的など
- **vocabulary**: 文学的、科学的、平易、格調高いなど  
- **approach**: 論理的、直感的、実例重視、哲学的など

### 4. サンプル回答（sampleResponses）
- その人物らしい表現や語彙を使用
- 専門分野の知識を適切に反映
- 質問に対する独特な視点やアプローチを示す

## カテゴリ管理

`categories` 配列で利用可能なカテゴリを管理:
- 文学者
- 科学者  
- 実業家
- 政治家
- 芸術家
- 哲学者
- 歴史上の人物

新しいカテゴリを追加する場合は、この配列に追加してください。

## ベストプラクティス

### 1. 一貫性の維持
- 同じ人物について複数の情報源を参照
- 矛盾する設定は避ける
- 時代背景と現代の文脈を適切に区別

### 2. 品質管理
- 定期的にサンプル回答をテスト
- ユーザーフィードバックを基に調整
- 不適切な内容が含まれないよう注意

### 3. パフォーマンス考慮
- 説明文は適度な長さに保つ
- 必要以上に複雑な設定は避ける
- APIレスポンス時間への影響を考慮

## テスト方法

1. **ローカルでのテスト**:
   ```bash
   npm run dev
   ```

2. **ペルソナの動作確認**:
   - ドロップダウンで対象ペルソナを選択
   - 専門分野に関する質問をしてみる
   - 一般的な質問での人物らしさを確認

3. **管理画面での確認**:
   - 「⚙️ 管理」ボタンでペルソナ一覧を表示
   - 設定内容が正しく読み込まれているか確認

## トラブルシューティング

### JSON構文エラー
- ブラウザの開発者ツールでエラーを確認
- JSONの構文チェッカーで検証
- カンマ、括弧の過不足に注意

### ペルソナが表示されない
- `active: true` が設定されているか確認
- APIエンドポイント `/api/personas` で直接確認
- ファイルパスが正しいか確認

### 回答が期待と異なる
- システムプロンプトの内容を見直し
- サンプル回答を追加・調整
- responseStyle の設定を詳細化

## 更新履歴

ペルソナデータを更新した際は、以下の情報を記録してください:
- 更新日時
- 変更内容
- 変更理由
- テスト結果

これにより、データの品質向上と継続的なメンテナンスが可能になります。